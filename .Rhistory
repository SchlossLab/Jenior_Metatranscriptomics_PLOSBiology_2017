exit()
quit()
# Start with clear environment
rm(list=ls())
gc()
# Load in functions
starting_dir <- getwd()
source('~/Desktop/Repositories/Jenior_Metatranscriptomics_2016/code/R/functions.R')
# Define input files
shared_otu_file <- 'data/16S_analysis/all_treatments.0.03.unique_list.conventional.shared'
otu_tax_file <- 'data/16S_analysis/formatted.all_treatments.0.03.cons.taxonomy'
shared_family_file <- 'data/16S_analysis/all_treatments.family.subsample.shared'
taxonomy_family_file <- 'data/16S_analysis/all_treatments.family.cons.format.taxonomy'
wetlab_file <- 'data/wetlab_assays.tsv'
metadata_file <- 'data/metadata.tsv'
# Define output files
plot_file <- 'results/figures/figure_1.pdf'
#-------------------------------------------------------------------------------------------------------------------------------------#
# Load in data
metadata <- read.delim(metadata_file, sep='\t', header=T, row.names=1)
metadata <- metadata[!rownames(metadata) %in% c('CefC5M2'), ] # Remove contaminated sample
metadata <- subset(metadata, type == 'conventional') # remove germfree
metadata$type <- NULL
metadata$cage <- NULL
metadata$mouse <- NULL
metadata$gender <- NULL
shared_otu <- read.delim(shared_otu_file, sep='\t', header=T, row.names=2)
shared_otu <- shared_otu[!rownames(shared_otu) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_otu <- shared_otu[,!(names(shared_otu) %in% c('Otu0004','Otu0308'))] # Remove residual C. difficile OTUs
shared_otu$numOtus <- NULL
shared_otu$label <- NULL
taxonomy_family <- read.delim(taxonomy_family_file, sep='\t', header=T)
shared_family <- read.delim(shared_family_file, sep='\t', header=T, row.names=2)
shared_family <- shared_family[!rownames(shared_family) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_family <- shared_family[ , !(names(shared_family) == 'Otu008')] # Remove residual C. difficile OTU
shared_family$numOtus <- NULL
shared_family$label <- NULL
wetlab <- read.delim(wetlab_file, sep='\t', header=T, row.names=1)
otu_tax <- read.delim(otu_tax_file, sep='\t', header=T, row.names=1)
rm(shared_family_file, taxonomy_family_file, metadata_file, wetlab_file, otu_tax_file)
#-------------------------------------------------------------------------------------------------------------------------------------#
# Format data
# OTU shared file
size <- ceiling(min(rowSums(shared_otu)) * 0.9)
#size <- 10000
#shared_otu <- shared_otu[rowSums(shared_otu) >= size,]
shared_otu <- rrarefy(shared_otu, size)
metadata_shared_otu <- clean_merge(metadata, shared_otu)
cef_shared_otu <- subset(metadata_shared_otu, abx == 'cefoperazone')
cef_shared_otu$abx <- NULL
cef_shared_otu$susceptibility <- NULL
strep_shared_otu <- subset(metadata_shared_otu, abx == 'streptomycin')
strep_shared_otu$abx <- NULL
strep_shared_otu$susceptibility <- NULL
clinda_shared_otu <- subset(metadata_shared_otu, abx == 'clindamycin')
clinda_shared_otu$abx <- NULL
clinda_shared_otu$susceptibility <- NULL
rm(metadata_shared_otu, shared_otu)
# Filter OTUs and convert to relative abundance
cef_shared_otu <- filter_table(cef_shared_otu)
strep_shared_otu <- filter_table(strep_shared_otu)
clinda_shared_otu <- filter_table(clinda_shared_otu)
# Transform abundances
#cef_shared_otu[,2:ncol(cef_shared_otu)] <- (cef_shared_otu[,2:ncol(cef_shared_otu)] / rowSums(cef_shared_otu[,2:ncol(cef_shared_otu)])) * 100
#strep_shared_otu[,2:ncol(strep_shared_otu)] <- (strep_shared_otu[,2:ncol(strep_shared_otu)] / rowSums(strep_shared_otu[,2:ncol(strep_shared_otu)])) * 100
#clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- (clinda_shared_otu[,2:ncol(clinda_shared_otu)] / rowSums(clinda_shared_otu[,2:ncol(clinda_shared_otu)])) * 100
cef_shared_otu[,2:ncol(cef_shared_otu)] <- log10(cef_shared_otu[,2:ncol(cef_shared_otu)] + 1)
strep_shared_otu[,2:ncol(strep_shared_otu)] <- log10(strep_shared_otu[,2:ncol(strep_shared_otu)] + 1)
clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- log10(clinda_shared_otu[,2:ncol(clinda_shared_otu)] + 1)
# Filter for significant OTUs by Wilcoxon
# Cef
cef_infected_otu <- subset(cef_shared_otu, infection == '630')
cef_infected_otu$infection <- NULL
cef_mock_otu <- subset(cef_shared_otu, infection == 'mock')
cef_mock_otu$infection <- NULL
rm(cef_shared_otu)
cef_infected_diversity <- diversity(cef_infected_otu, index='invsimpson')
cef_infected_diversity <- diversity(cef_infected_otu, index='inv')
cef_infected_diversity <- diversity(cef_infected_otu, 'inv')
# Start with clear environment
rm(list=ls())
gc()
# Load in functions
starting_dir <- getwd()
source('~/Desktop/Repositories/Jenior_Metatranscriptomics_2016/code/R/functions.R')
# Define input files
shared_otu_file <- 'data/16S_analysis/all_treatments.0.03.unique_list.conventional.shared'
otu_tax_file <- 'data/16S_analysis/formatted.all_treatments.0.03.cons.taxonomy'
shared_family_file <- 'data/16S_analysis/all_treatments.family.subsample.shared'
taxonomy_family_file <- 'data/16S_analysis/all_treatments.family.cons.format.taxonomy'
wetlab_file <- 'data/wetlab_assays.tsv'
metadata_file <- 'data/metadata.tsv'
# Define output files
plot_file <- 'results/figures/figure_1.pdf'
#-------------------------------------------------------------------------------------------------------------------------------------#
# Load in data
metadata <- read.delim(metadata_file, sep='\t', header=T, row.names=1)
metadata <- metadata[!rownames(metadata) %in% c('CefC5M2'), ] # Remove contaminated sample
metadata <- subset(metadata, type == 'conventional') # remove germfree
metadata$type <- NULL
metadata$cage <- NULL
metadata$mouse <- NULL
metadata$gender <- NULL
shared_otu <- read.delim(shared_otu_file, sep='\t', header=T, row.names=2)
shared_otu <- shared_otu[!rownames(shared_otu) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_otu <- shared_otu[,!(names(shared_otu) %in% c('Otu0004','Otu0308'))] # Remove residual C. difficile OTUs
shared_otu$numOtus <- NULL
shared_otu$label <- NULL
taxonomy_family <- read.delim(taxonomy_family_file, sep='\t', header=T)
shared_family <- read.delim(shared_family_file, sep='\t', header=T, row.names=2)
shared_family <- shared_family[!rownames(shared_family) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_family <- shared_family[ , !(names(shared_family) == 'Otu008')] # Remove residual C. difficile OTU
shared_family$numOtus <- NULL
shared_family$label <- NULL
wetlab <- read.delim(wetlab_file, sep='\t', header=T, row.names=1)
otu_tax <- read.delim(otu_tax_file, sep='\t', header=T, row.names=1)
rm(shared_family_file, taxonomy_family_file, metadata_file, wetlab_file, otu_tax_file)
#-------------------------------------------------------------------------------------------------------------------------------------#
# Format data
# OTU shared file
size <- ceiling(min(rowSums(shared_otu)) * 0.9)
#size <- 10000
#shared_otu <- shared_otu[rowSums(shared_otu) >= size,]
shared_otu <- rrarefy(shared_otu, size)
shared_otu <- filter_table(shared_otu) # filter shared
metadata_shared_otu <- clean_merge(metadata, shared_otu)
cef_shared_otu <- subset(metadata_shared_otu, abx == 'cefoperazone')
cef_shared_otu$abx <- NULL
cef_shared_otu$susceptibility <- NULL
strep_shared_otu <- subset(metadata_shared_otu, abx == 'streptomycin')
strep_shared_otu$abx <- NULL
strep_shared_otu$susceptibility <- NULL
clinda_shared_otu <- subset(metadata_shared_otu, abx == 'clindamycin')
clinda_shared_otu$abx <- NULL
clinda_shared_otu$susceptibility <- NULL
rm(metadata_shared_otu, shared_otu)
# Transform abundances
#cef_shared_otu[,2:ncol(cef_shared_otu)] <- (cef_shared_otu[,2:ncol(cef_shared_otu)] / rowSums(cef_shared_otu[,2:ncol(cef_shared_otu)])) * 100
#strep_shared_otu[,2:ncol(strep_shared_otu)] <- (strep_shared_otu[,2:ncol(strep_shared_otu)] / rowSums(strep_shared_otu[,2:ncol(strep_shared_otu)])) * 100
#clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- (clinda_shared_otu[,2:ncol(clinda_shared_otu)] / rowSums(clinda_shared_otu[,2:ncol(clinda_shared_otu)])) * 100
cef_shared_otu[,2:ncol(cef_shared_otu)] <- log10(cef_shared_otu[,2:ncol(cef_shared_otu)] + 1)
strep_shared_otu[,2:ncol(strep_shared_otu)] <- log10(strep_shared_otu[,2:ncol(strep_shared_otu)] + 1)
clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- log10(clinda_shared_otu[,2:ncol(clinda_shared_otu)] + 1)
# Filter for significant OTUs by Wilcoxon
# Cef
cef_infected_otu <- subset(cef_shared_otu, infection == '630')
cef_infected_otu$infection <- NULL
cef_mock_otu <- subset(cef_shared_otu, infection == 'mock')
cef_mock_otu$infection <- NULL
rm(cef_shared_otu)
View(cef_infected_otu)
cef_infected_diversity <- diversity(cef_infected_otu, 'inv')
if ('igraph' %in% installed.packages()[,'Package'] == FALSE) {install.packages('igraph', quiet=TRUE)}
library('igraph', verbose=FALSE, character.only=TRUE)
# Start with clear environment
rm(list=ls())
gc()
# Load in functions
starting_dir <- getwd()
source('~/Desktop/Repositories/Jenior_Metatranscriptomics_2016/code/R/functions.R')
# Define input files
shared_otu_file <- 'data/16S_analysis/all_treatments.0.03.unique_list.conventional.shared'
otu_tax_file <- 'data/16S_analysis/formatted.all_treatments.0.03.cons.taxonomy'
shared_family_file <- 'data/16S_analysis/all_treatments.family.subsample.shared'
taxonomy_family_file <- 'data/16S_analysis/all_treatments.family.cons.format.taxonomy'
wetlab_file <- 'data/wetlab_assays.tsv'
metadata_file <- 'data/metadata.tsv'
# Define output files
plot_file <- 'results/figures/figure_1.pdf'
#-------------------------------------------------------------------------------------------------------------------------------------#
# Load in data
metadata <- read.delim(metadata_file, sep='\t', header=T, row.names=1)
metadata <- metadata[!rownames(metadata) %in% c('CefC5M2'), ] # Remove contaminated sample
metadata <- subset(metadata, type == 'conventional') # remove germfree
metadata$type <- NULL
metadata$cage <- NULL
metadata$mouse <- NULL
metadata$gender <- NULL
shared_otu <- read.delim(shared_otu_file, sep='\t', header=T, row.names=2)
shared_otu <- shared_otu[!rownames(shared_otu) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_otu <- shared_otu[,!(names(shared_otu) %in% c('Otu0004','Otu0308'))] # Remove residual C. difficile OTUs
shared_otu$numOtus <- NULL
shared_otu$label <- NULL
taxonomy_family <- read.delim(taxonomy_family_file, sep='\t', header=T)
shared_family <- read.delim(shared_family_file, sep='\t', header=T, row.names=2)
shared_family <- shared_family[!rownames(shared_family) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_family <- shared_family[ , !(names(shared_family) == 'Otu008')] # Remove residual C. difficile OTU
shared_family$numOtus <- NULL
shared_family$label <- NULL
wetlab <- read.delim(wetlab_file, sep='\t', header=T, row.names=1)
otu_tax <- read.delim(otu_tax_file, sep='\t', header=T, row.names=1)
rm(shared_family_file, taxonomy_family_file, metadata_file, wetlab_file, otu_tax_file)
#-------------------------------------------------------------------------------------------------------------------------------------#
# Format data
# OTU shared file
size <- ceiling(min(rowSums(shared_otu)) * 0.9)
#size <- 10000
#shared_otu <- shared_otu[rowSums(shared_otu) >= size,]
shared_otu <- rrarefy(shared_otu, size)
shared_otu <- filter_table(shared_otu) # filter shared
metadata_shared_otu <- clean_merge(metadata, shared_otu)
cef_shared_otu <- subset(metadata_shared_otu, abx == 'cefoperazone')
cef_shared_otu$abx <- NULL
cef_shared_otu$susceptibility <- NULL
strep_shared_otu <- subset(metadata_shared_otu, abx == 'streptomycin')
strep_shared_otu$abx <- NULL
strep_shared_otu$susceptibility <- NULL
clinda_shared_otu <- subset(metadata_shared_otu, abx == 'clindamycin')
clinda_shared_otu$abx <- NULL
clinda_shared_otu$susceptibility <- NULL
rm(metadata_shared_otu, shared_otu)
# Transform abundances
#cef_shared_otu[,2:ncol(cef_shared_otu)] <- (cef_shared_otu[,2:ncol(cef_shared_otu)] / rowSums(cef_shared_otu[,2:ncol(cef_shared_otu)])) * 100
#strep_shared_otu[,2:ncol(strep_shared_otu)] <- (strep_shared_otu[,2:ncol(strep_shared_otu)] / rowSums(strep_shared_otu[,2:ncol(strep_shared_otu)])) * 100
#clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- (clinda_shared_otu[,2:ncol(clinda_shared_otu)] / rowSums(clinda_shared_otu[,2:ncol(clinda_shared_otu)])) * 100
cef_shared_otu[,2:ncol(cef_shared_otu)] <- log10(cef_shared_otu[,2:ncol(cef_shared_otu)] + 1)
strep_shared_otu[,2:ncol(strep_shared_otu)] <- log10(strep_shared_otu[,2:ncol(strep_shared_otu)] + 1)
clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- log10(clinda_shared_otu[,2:ncol(clinda_shared_otu)] + 1)
# Filter for significant OTUs by Wilcoxon
# Cef
cef_infected_otu <- subset(cef_shared_otu, infection == '630')
cef_infected_otu$infection <- NULL
cef_mock_otu <- subset(cef_shared_otu, infection == 'mock')
cef_mock_otu$infection <- NULL
rm(cef_shared_otu)
cef_infected_diversity <- diversity(cef_infected_otu, 'inv')
# Start with clear environment
rm(list=ls())
gc()
# Load in functions
starting_dir <- getwd()
source('~/Desktop/Repositories/Jenior_Metatranscriptomics_2016/code/R/functions.R')
# Define input files
shared_otu_file <- 'data/16S_analysis/all_treatments.0.03.unique_list.conventional.shared'
otu_tax_file <- 'data/16S_analysis/formatted.all_treatments.0.03.cons.taxonomy'
shared_family_file <- 'data/16S_analysis/all_treatments.family.subsample.shared'
taxonomy_family_file <- 'data/16S_analysis/all_treatments.family.cons.format.taxonomy'
wetlab_file <- 'data/wetlab_assays.tsv'
metadata_file <- 'data/metadata.tsv'
# Define output files
plot_file <- 'results/figures/figure_1.pdf'
#-------------------------------------------------------------------------------------------------------------------------------------#
# Load in data
metadata <- read.delim(metadata_file, sep='\t', header=T, row.names=1)
metadata <- metadata[!rownames(metadata) %in% c('CefC5M2'), ] # Remove contaminated sample
metadata <- subset(metadata, type == 'conventional') # remove germfree
metadata$type <- NULL
metadata$cage <- NULL
metadata$mouse <- NULL
metadata$gender <- NULL
shared_otu <- read.delim(shared_otu_file, sep='\t', header=T, row.names=2)
shared_otu <- shared_otu[!rownames(shared_otu) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_otu <- shared_otu[,!(names(shared_otu) %in% c('Otu0004','Otu0308'))] # Remove residual C. difficile OTUs
shared_otu$numOtus <- NULL
shared_otu$label <- NULL
taxonomy_family <- read.delim(taxonomy_family_file, sep='\t', header=T)
shared_family <- read.delim(shared_family_file, sep='\t', header=T, row.names=2)
shared_family <- shared_family[!rownames(shared_family) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_family <- shared_family[ , !(names(shared_family) == 'Otu008')] # Remove residual C. difficile OTU
shared_family$numOtus <- NULL
shared_family$label <- NULL
wetlab <- read.delim(wetlab_file, sep='\t', header=T, row.names=1)
otu_tax <- read.delim(otu_tax_file, sep='\t', header=T, row.names=1)
rm(shared_family_file, taxonomy_family_file, metadata_file, wetlab_file, otu_tax_file)
#-------------------------------------------------------------------------------------------------------------------------------------#
# Format data
# OTU shared file
size <- ceiling(min(rowSums(shared_otu)) * 0.9)
#size <- 10000
#shared_otu <- shared_otu[rowSums(shared_otu) >= size,]
shared_otu <- rrarefy(shared_otu, size)
shared_otu <- filter_table(shared_otu) # filter shared
metadata_shared_otu <- clean_merge(metadata, shared_otu)
cef_shared_otu <- subset(metadata_shared_otu, abx == 'cefoperazone')
cef_shared_otu$abx <- NULL
cef_shared_otu$susceptibility <- NULL
strep_shared_otu <- subset(metadata_shared_otu, abx == 'streptomycin')
strep_shared_otu$abx <- NULL
strep_shared_otu$susceptibility <- NULL
clinda_shared_otu <- subset(metadata_shared_otu, abx == 'clindamycin')
clinda_shared_otu$abx <- NULL
clinda_shared_otu$susceptibility <- NULL
rm(metadata_shared_otu, shared_otu)
# Transform abundances
#cef_shared_otu[,2:ncol(cef_shared_otu)] <- (cef_shared_otu[,2:ncol(cef_shared_otu)] / rowSums(cef_shared_otu[,2:ncol(cef_shared_otu)])) * 100
#strep_shared_otu[,2:ncol(strep_shared_otu)] <- (strep_shared_otu[,2:ncol(strep_shared_otu)] / rowSums(strep_shared_otu[,2:ncol(strep_shared_otu)])) * 100
#clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- (clinda_shared_otu[,2:ncol(clinda_shared_otu)] / rowSums(clinda_shared_otu[,2:ncol(clinda_shared_otu)])) * 100
cef_shared_otu[,2:ncol(cef_shared_otu)] <- log10(cef_shared_otu[,2:ncol(cef_shared_otu)] + 1)
strep_shared_otu[,2:ncol(strep_shared_otu)] <- log10(strep_shared_otu[,2:ncol(strep_shared_otu)] + 1)
clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- log10(clinda_shared_otu[,2:ncol(clinda_shared_otu)] + 1)
# Filter for significant OTUs by Wilcoxon
# Cef
cef_infected_otu <- subset(cef_shared_otu, infection == '630')
cef_infected_otu$infection <- NULL
cef_mock_otu <- subset(cef_shared_otu, infection == 'mock')
cef_mock_otu$infection <- NULL
rm(cef_shared_otu)
cef_infected_diversity <- diversity(cef_infected_otu, 'inv')
?diversity
# Start with clear environment
rm(list=ls())
gc()
# Load in functions
starting_dir <- getwd()
source('~/Desktop/Repositories/Jenior_Metatranscriptomics_2016/code/R/functions.R')
# Define input files
shared_otu_file <- 'data/16S_analysis/all_treatments.0.03.unique_list.conventional.shared'
otu_tax_file <- 'data/16S_analysis/formatted.all_treatments.0.03.cons.taxonomy'
shared_family_file <- 'data/16S_analysis/all_treatments.family.subsample.shared'
taxonomy_family_file <- 'data/16S_analysis/all_treatments.family.cons.format.taxonomy'
wetlab_file <- 'data/wetlab_assays.tsv'
metadata_file <- 'data/metadata.tsv'
# Define output files
plot_file <- 'results/figures/figure_1.pdf'
#-------------------------------------------------------------------------------------------------------------------------------------#
# Load in data
metadata <- read.delim(metadata_file, sep='\t', header=T, row.names=1)
metadata <- metadata[!rownames(metadata) %in% c('CefC5M2'), ] # Remove contaminated sample
metadata <- subset(metadata, type == 'conventional') # remove germfree
metadata$type <- NULL
metadata$cage <- NULL
metadata$mouse <- NULL
metadata$gender <- NULL
shared_otu <- read.delim(shared_otu_file, sep='\t', header=T, row.names=2)
shared_otu <- shared_otu[!rownames(shared_otu) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_otu <- shared_otu[,!(names(shared_otu) %in% c('Otu0004','Otu0308'))] # Remove residual C. difficile OTUs
shared_otu$numOtus <- NULL
shared_otu$label <- NULL
taxonomy_family <- read.delim(taxonomy_family_file, sep='\t', header=T)
shared_family <- read.delim(shared_family_file, sep='\t', header=T, row.names=2)
shared_family <- shared_family[!rownames(shared_family) %in% c('CefC5M2'), ]  # Remove contaminated sample
shared_family <- shared_family[ , !(names(shared_family) == 'Otu008')] # Remove residual C. difficile OTU
shared_family$numOtus <- NULL
shared_family$label <- NULL
wetlab <- read.delim(wetlab_file, sep='\t', header=T, row.names=1)
otu_tax <- read.delim(otu_tax_file, sep='\t', header=T, row.names=1)
rm(shared_family_file, taxonomy_family_file, metadata_file, wetlab_file, otu_tax_file)
#-------------------------------------------------------------------------------------------------------------------------------------#
# Format data
# OTU shared file
size <- ceiling(min(rowSums(shared_otu)) * 0.9)
#size <- 10000
#shared_otu <- shared_otu[rowSums(shared_otu) >= size,]
shared_otu <- rrarefy(shared_otu, size)
shared_otu <- filter_table(shared_otu) # filter shared
metadata_shared_otu <- clean_merge(metadata, shared_otu)
cef_shared_otu <- subset(metadata_shared_otu, abx == 'cefoperazone')
cef_shared_otu$abx <- NULL
cef_shared_otu$susceptibility <- NULL
strep_shared_otu <- subset(metadata_shared_otu, abx == 'streptomycin')
strep_shared_otu$abx <- NULL
strep_shared_otu$susceptibility <- NULL
clinda_shared_otu <- subset(metadata_shared_otu, abx == 'clindamycin')
clinda_shared_otu$abx <- NULL
clinda_shared_otu$susceptibility <- NULL
rm(metadata_shared_otu, shared_otu)
# Transform abundances
#cef_shared_otu[,2:ncol(cef_shared_otu)] <- (cef_shared_otu[,2:ncol(cef_shared_otu)] / rowSums(cef_shared_otu[,2:ncol(cef_shared_otu)])) * 100
#strep_shared_otu[,2:ncol(strep_shared_otu)] <- (strep_shared_otu[,2:ncol(strep_shared_otu)] / rowSums(strep_shared_otu[,2:ncol(strep_shared_otu)])) * 100
#clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- (clinda_shared_otu[,2:ncol(clinda_shared_otu)] / rowSums(clinda_shared_otu[,2:ncol(clinda_shared_otu)])) * 100
cef_shared_otu[,2:ncol(cef_shared_otu)] <- log10(cef_shared_otu[,2:ncol(cef_shared_otu)] + 1)
strep_shared_otu[,2:ncol(strep_shared_otu)] <- log10(strep_shared_otu[,2:ncol(strep_shared_otu)] + 1)
clinda_shared_otu[,2:ncol(clinda_shared_otu)] <- log10(clinda_shared_otu[,2:ncol(clinda_shared_otu)] + 1)
# Filter for significant OTUs by Wilcoxon
# Cef
cef_infected_otu <- subset(cef_shared_otu, infection == '630')
cef_infected_otu$infection <- NULL
cef_mock_otu <- subset(cef_shared_otu, infection == 'mock')
cef_mock_otu$infection <- NULL
rm(cef_shared_otu)
cef_infected_diversity <- diversity(cef_infected_otu, 'inv')
cef_infected_diversity <- vegan.diversity(cef_infected_otu, 'inv')
