'I. Arginine and proline metabolism','J. Fructose and mannose metabolism','K. Pentose phosphate pathway')
#-------------------------------------------------------------------------------------------------------------------------#
# Generate figure
pdf(file=plot_file, width=15, height=20)
par(mar=c(5,26,1,2), mgp=c(2.5, 0.75, 0), las=1, xaxs='i', yaxs='i')
barplot(minority_genes, xaxt='n', yaxt='n', xlim=c(0,10), ylim=c(0,88), beside=TRUE, horiz=TRUE, width=0.75,
xlab='', ylab='', col=treatment_colors, cex.axis=1.2, angle=20, density=c(NA,20,NA))
axis(1, at=seq(0,10,2), label=seq(0,10,2), cex.axis=1.6)
minor.ticks.axis(1, 10, mn=0, mx=10)
axis(side=2, labels=gene_names, at=seq(2,86,3), tick=FALSE, cex.axis=1.7)
mtext(expression(paste('Normalized cDNA Reads (',log[2],')')), side=1, padj=2.5, cex=1.8)
abline(h=seq(3.4,84.4,3), lty=2)
legend('topright', legend=c('No Antibiotics','Streptomycin-pretreated','Cefoperazone-pretreated','Clindamycin-pretreated'),
pt.bg=c('gray70',strep_col,cef_col,clinda_col), pch=22, pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
legend(x=7, y=78.25, legend=c('630-infected','Mock-infected'), angle=20, density=c(20,NA),
pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
box()
dev.off()
# Pathway legend
pdf(file=legend_file, width=40, height=10)
par(mar=c(0,0,0,0))
plot(0, type='n', xlim=c(-25,25), ylim=c(-6,6), pch=20, xaxt='n', yaxt='n', xlab='', ylab='')
legend('center', legend=pathways, pt.cex=0, cex=3, ncol=3, box.lwd=2)
dev.off()
#-------------------------------------------------------------------------------------------------------------------------#
# Clean up
#for (dep in deps){
#  pkg <- paste('package:', dep, sep='')
#  detach(pkg, character.only = TRUE)}
#setwd(starting_dir)
#rm(list=ls())
#gc()
# Generate figure
pdf(file=plot_file, width=15, height=20)
par(mar=c(5,26,1,2), mgp=c(2.5, 0.75, 0), las=1, xaxs='i', yaxs='i')
barplot(minority_genes, xaxt='n', yaxt='n', xlim=c(0,10), ylim=c(0,88), beside=TRUE, horiz=TRUE, width=0.75,
xlab='', ylab='', col=treatment_colors, cex.axis=1.2, angle=20, density=c(NA,20,NA))
axis(1, at=seq(0,10,2), label=seq(0,10,2), cex.axis=1.6)
minor.ticks.axis(1, 10, mn=0, mx=10)
axis(side=2, labels=gene_names, at=seq(2,86,3), tick=FALSE, cex.axis=1.7)
mtext(expression(paste('Normalized cDNA Reads (',log[2],')')), side=1, padj=2.5, cex=1.8)
abline(h=seq(3.4,84.4,3), lty=2)
legend('topright', legend=c('No Antibiotics','Streptomycin-pretreated','Cefoperazone-pretreated','Clindamycin-pretreated'),
pt.bg=c('gray70',strep_col,cef_col,clinda_col), pch=22, pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
legend(x=6.5, y=78.25, legend=c('630-infected','Mock-infected'), angle=20, density=c(20,NA),
pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
box()
dev.off()
pdf(file=plot_file, width=15, height=20)
par(mar=c(5,26,1,2), mgp=c(2.5, 0.75, 0), las=1, xaxs='i', yaxs='i')
barplot(minority_genes, xaxt='n', yaxt='n', xlim=c(0,10), ylim=c(0,88), beside=TRUE, horiz=TRUE, width=0.75,
xlab='', ylab='', col=treatment_colors, cex.axis=1.2, angle=20, density=c(NA,20,NA))
axis(1, at=seq(0,10,2), label=seq(0,10,2), cex.axis=1.6)
minor.ticks.axis(1, 10, mn=0, mx=10)
axis(side=2, labels=gene_names, at=seq(2,86,3), tick=FALSE, cex.axis=1.7)
mtext(expression(paste('Normalized cDNA Reads (',log[2],')')), side=1, padj=2.5, cex=1.8)
abline(h=seq(3.4,84.4,3), lty=2)
legend('topright', legend=c('No Antibiotics','Streptomycin-pretreated','Cefoperazone-pretreated','Clindamycin-pretreated'),
pt.bg=c('gray70',strep_col,cef_col,clinda_col), pch=22, pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
legend(x=6.7, y=78.25, legend=c('630-infected','Mock-infected'), angle=20, density=c(20,NA),
pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
box()
dev.off()
# Pathway legend
pdf(file=legend_file, width=40, height=10)
par(mar=c(0,0,0,0))
plot(0, type='n', xlim=c(-25,25), ylim=c(-6,6), pch=20, xaxt='n', yaxt='n', xlab='', ylab='')
legend('center', legend=pathways, pt.cex=0, cex=3, ncol=3, box.lwd=2)
dev.off()
pdf(file=plot_file, width=15, height=20)
par(mar=c(5,26,1,2), mgp=c(2.5, 0.75, 0), las=1, xaxs='i', yaxs='i')
barplot(minority_genes, xaxt='n', yaxt='n', xlim=c(0,10), ylim=c(0,88), beside=TRUE, horiz=TRUE, width=0.75,
xlab='', ylab='', col=treatment_colors, cex.axis=1.2, angle=20, density=c(NA,20,NA))
axis(1, at=seq(0,10,2), label=seq(0,10,2), cex.axis=1.6)
minor.ticks.axis(1, 10, mn=0, mx=10)
axis(side=2, labels=gene_names, at=seq(2,86,3), tick=FALSE, cex.axis=1.7)
mtext(expression(paste('Normalized cDNA Reads (',log[2],')')), side=1, padj=2.5, cex=1.8)
abline(h=seq(3.4,84.4,3), lty=2)
legend('topright', legend=c('No Antibiotics','Streptomycin-pretreated','Cefoperazone-pretreated','Clindamycin-pretreated'),
pt.bg=c('gray70',strep_col,cef_col,clinda_col), pch=22, pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
legend(x=6.6, y=78.25, legend=c('630-infected','Mock-infected'), angle=20, density=c(20,NA),
pt.cex=3.3, cex=2, box.lwd=1, box.col="black", bg="white")
box()
dev.off()
for (dep in deps){
pkg <- paste('package:', dep, sep='')
detach(pkg, character.only = TRUE)}
setwd(starting_dir)
rm(list=ls())
gc()
cef_630_metagenome <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=FALSE, row.names=1)
cef_630_metagenome <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
View(cef_630_metagenome)
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda  <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
su(cef)
sum(cef)
sum(clinda)
10^ceiling(log10(signif(as.numeric(sum(cef)), digits=1)))
10^ceiling(log10(signif(as.numeric(sum(cef)), digits=2)))
10^ceiling(log10(signif(as.numeric(sum(cef)), digits=1))
)
signif(as.numeric(sum(cef))
)
25000/100
library(vegan)
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- c(0)
current <- 0
while (current < 25000)
{
current <- current + 100
subVect <- c(subVect, current)
}
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
options(warn=0)
return(rareVect)
}
test <- stepRarefy(cef)
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- c(0)
current <- 0
while (current < 25000)
{
current <- current + 100
subVect <- c(subVect, current)
}
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep)
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep, stepRarefy)
max(max(cef_collectors),max(clinda_collectors),max(strep_collectors))
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,25000), ylim=c(0,1100), xlab='Sampling Depth', ylab='Detected Genes')
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', clinda_col), pch=22, pt.cex=0, lwd=3)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', type='p', pch=17, cex=1.5)
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', type='p', pch=17, cex=1.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', type='p', pch=17, cex=1.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,2000), ylim=c(0,1100), xlab='Sampling Depth', ylab='Detected Genes')
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', type='p', pch=17, cex=1.5)
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', type='p', pch=17, cex=1.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', type='p', pch=17, cex=1.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,500), ylim=c(0,1100), xlab='Sampling Depth', ylab='Detected Genes')
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', type='p', pch=17, cex=1.5)
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', type='p', pch=17, cex=1.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', type='p', pch=17, cex=1.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1100), xlab='Sampling Depth', ylab='Detected Genes')
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', type='p', pch=17, cex=1.5)
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', type='p', pch=17, cex=1.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', type='p', pch=17, cex=1.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1100), xlab='Sampling Depth', ylab='Detected Genes')
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1100), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1100), xlab='Sampling Depth', ylab='Detected Genes')
#axis(1, at=seq(1,12,2), label=c(1,100,10000,1000000,100000000,1000000000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1100), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=4, height=3)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
dev.off()
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,2), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
dev.off()
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=2.5)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
dev.off()
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(predict(cef_collectors), col='blue', lwd=2.5)
installed.packages('splines')
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=4)
lines(strep_collectors, col='red', lwd=2.5)
lines(clinda_collectors, col='green', lwd=2.5)
lines(cef_collectors, col='blue', lwd=3)
lines(strep_collectors, col='red', lwd=3)
lines(clinda_collectors, col='green', lwd=3)
installed.packages('splines')
require(splines)
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
rareVect <-predict(interpSpline(subVect, rareVect))
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep, stepRarefy)
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=3)
lines(strep_collectors, col='red', lwd=3)
lines(clinda_collectors, col='green', lwd=3)
dev.off()
cef_collectors[2]
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
rareVect <-predict(interpSpline(subVect, rareVect))[2]
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep, stepRarefy)
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
rareVect <- as.vector(predict(interpSpline(subVect, rareVect))[2])
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep, stepRarefy)
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=3)
lines(strep_collectors, col='red', lwd=3)
lines(clinda_collectors, col='green', lwd=3)
dev.off()
View(cef_collectors)
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
rareVect <- as.vector(predict(interpSpline(subVect, rareVect))[2])
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
View(cef_collectors)
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
rareVect <- predict(interpSpline(subVect, rareVect))
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
cef_collectors$y
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
rareVect <- predict(interpSpline(subVect, rareVect))$y
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep, stepRarefy)
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=3)
lines(strep_collectors, col='red', lwd=3)
lines(clinda_collectors, col='green', lwd=3)
dev.off()
stepRarefy <- function(abundVect){
options(warn=-1)
rareVect <- c()
subVect <- seq(0, 25000, 100)
for (x in 1:length(subVect)) {
rareVect[x] <- as.numeric(sum(as.vector(rrarefy(abundVect, sample=subVect[x])) != 0))
}
options(warn=0)
return(rareVect)
}
cdf_transcription <- read.delim('~/Desktop/cdf_invivo_transcript.tsv',
sep='\t', header=TRUE, row.names=1)
cef <- cdf_transcription$cefoperazone.pretreated..normalized.reads.
clinda <- cdf_transcription$clindamycin.pretreated..normalized.reads.
strep <- cdf_transcription$streptomycin.pretreated..normalized.reads.
rm(cdf_transcription)
cef_collectors <- stepRarefy(cef)
clinda_collectors <- stepRarefy(clinda)
strep_collectors <- stepRarefy(strep)
rm(cef, clinda, strep, stepRarefy)
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000), cex.axis=0.9)
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=3)
lines(strep_collectors, col='red', lwd=3)
lines(clinda_collectors, col='green', lwd=3)
dev.off()
pdf(file='~/Desktop/cdf_transcript_collectors.pdf', width=5, height=4)
par(mar=c(4,4,1,1), mgp=c(2.5, 0.75, 0), las=1)
plot(1, type='n', xlim=c(0,260), ylim=c(0,1200), xaxt='n', xlab='Sampling Depth', ylab='Detected Genes')
axis(1, at=seq(0,250,50), label=seq(0,25000,5000))
legend('bottomright', legend=c('Streptomycin','Cefoperazone','Clindamycin'),
col=c('red', 'blue', 'green'), pch=22, pt.cex=0, lwd=3)
box()
lines(cef_collectors, col='blue', lwd=3)
lines(strep_collectors, col='red', lwd=3)
lines(clinda_collectors, col='green', lwd=3)
dev.off()
